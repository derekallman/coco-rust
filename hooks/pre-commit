#!/usr/bin/env bash
set -e

# Ensure cargo is on PATH (git hooks don't inherit shell profile)
[ -f "$HOME/.cargo/env" ] && source "$HOME/.cargo/env"

echo "Running pre-commit checks..."

echo "[1/3] cargo fmt --all -- --check"
cargo fmt --all -- --check

echo "[2/3] cargo clippy --workspace --all-targets -- -D warnings"
cargo clippy --workspace --all-targets -- -D warnings

echo "[3/3] cargo test"
cargo test

echo "All pre-commit checks passed."
